# まじん式プロンプト v3（プリセット保存対応版）

このプロジェクトは、**まじん式プロンプト v3** をベースに改良した **Google スプレッドシート連携対応版**です。  
スプレッドシートにプリセットを保存できるため、**ブラウザを閉じても設定が消えず、チームでも共有して使える**のが特長です。

---

## 🎯 概要

| 項目 | 内容 |
|------|------|
| ツール名 | スライド作成ツール（まじん式プロンプト v3 改） |
| 開発環境 | Google Apps Script（GAS） + HTML / JavaScript |
| 保存先 | Google スプレッドシート（プリセット設定） |
| 主な機能 | スライド自動生成・テーマ設定・プリセット保存／読込／削除 |
| 想定用途 | チームや自治体・学校でのプレゼン資料生成支援 |

---

## 🧩 機能一覧

### 🔹 スライド生成機能
- JSON形式の入力から自動で Google スライドを作成  
- タイトル・セクション・コンテンツ・クロージングの4タイプをサポート  
- 日付・フッター・バー表示などON/OFF切り替え可能  

### 🔹 プリセット保存機能（v3改）
- スプレッドシートに設定（色・フォント・ロゴ・背景）を保存  
- 「保存」「削除」「呼び出し」がブラウザ上で完結  
- 組織やチームで **共通デザインテンプレート** を共有可能  

### 🔹 デザインカスタマイズ
- プライマリカラー・グラデーション・フォント選択  
- ロゴ画像や背景画像のURL入力（Drive/外部URL対応）  
- JSON構文チェック・色プレビューつきUI  

---

## 🗂️ フォルダ構成

```
majin-v3/
├── index.html        ← UI（スプレッドシート連携画面）
├── コード.gs          ← GAS側バックエンド（スライド生成・プリセット保存処理）
├── presets.csv       ← スプレッドシートのサンプルデータ
└── README.md         ← この説明書
```

---

## ⚙️ セットアップ手順

### 1️⃣ Google Apps Script プロジェクトを作成
- Google ドライブで「新規 → その他 → Google Apps Script」
- `コード.gs` の内容を貼り付け  
- 「ファイルを追加」で `index.html` を貼り付け  

### 2️⃣ スプレッドシートを準備
- 新しいスプレッドシートを作成  
- 1行目に以下の見出しを入れる（または `presets.csv` をインポート）

| 名前 | プライマリカラー | フォント | フッターテキスト | 保存先フォルダURL | タイトルアンダーライン | フッターバー | 日付表示 | グラデーション適用 | グラデーション開始色 | グラデーション終了色 | ヘッダーロゴ | クロージングロゴ | タイトル背景 | セクション背景 | メイン背景 | クロージング背景 |

- スクリプトの `SPREADSHEET_ID` にこのシートのIDを指定

### 3️⃣ Webアプリとしてデプロイ
- メニューから「デプロイ → 新しいデプロイ」  
- 種類を「ウェブアプリ」  
- 実行者: 自分 / アクセス権: 全員（または組織内）  
- URLをコピーして使用  

---

## 📋 使用例

```json
[
  { "type": "title", "title": "地域DXの推進", "date": "2025年10月15日" },
  { "type": "section", "title": "現状と課題" },
  { "type": "content", "title": "デジタル化の現状", "points": [
    "基盤整備の進展",
    "人材不足とノウハウの課題",
    "クラウド活用による効率化"
  ]},
  { "type": "closing" }
]
```

---

## 🧠 仕組みの概要

- **index.html**：GASと連携してプリセット読込・保存・削除を実行／JSON検証とプレビュー  
- **コード.gs**：
  - `getPresetsFromSheet()` … スプレッドシートから設定を取得  
  - `savePresetToSheet(name, settings)` … 新規プリセットを保存  
  - `deletePresetFromSheet(name)` … プリセットを削除  
  - `generateSlidesFromWebApp(json, settings)` … スライド自動生成  

---

---

## 📘 クレジット & ライセンス

- 原案: まじん式プロンプト v3  
- 改良: MinamiGoen（美波御塩）  
- 技術: Google Apps Script, HTML, JavaScript  
- License: MIT
